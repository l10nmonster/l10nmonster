import{u as m,j as e,B as t,S as g,V as C,T as n,r as f,I as E,w,x as z,G as D}from"./vendor-BVgSJH5C.js";import{a as y,S as L,f as b}from"./index-543A5WcJ.js";const v=({channelId:l})=>{const[d,h]=f.useState(!1),[i,x]=f.useState(!0),c=f.useRef(null);f.useEffect(()=>{const s=new IntersectionObserver(a=>{a.forEach(j=>{j.isIntersecting&&(h(!0),s.disconnect())})},{rootMargin:"200px",threshold:0});return c.current&&s.observe(c.current),()=>s.disconnect()},[]);const{data:r,isLoading:p,error:u}=m({queryKey:["channel",l],queryFn:()=>b(`/api/channel/${l}`),enabled:d}),o=r?.projects||[];return r?.ts,r?.store,e.jsxs(t,{ref:c,p:6,borderWidth:"2px",borderRadius:"lg",bg:"white",borderColor:"green.200",minW:"600px",maxW:"1200px",w:"100%",children:[e.jsxs(t,{display:"flex",alignItems:"center",gap:3,flexWrap:"wrap",mb:6,pb:4,borderBottom:"2px",borderColor:"green.100",children:[e.jsx(E,{"aria-label":i?"Collapse channel":"Expand channel",onClick:()=>x(!i),variant:"ghost",size:"sm",children:i?"▼":"▶"}),e.jsxs(t,{children:[e.jsx(n,{fontSize:"sm",color:"fg.muted",mb:1,children:"Channel"}),e.jsx(n,{fontSize:"lg",fontWeight:"bold",color:"green.600",children:l})]}),r&&e.jsx(t,{flex:"1",textAlign:"right",children:(()=>{const s=r?.ts,a=r?.store;if(!s)return e.jsx(n,{fontSize:"sm",color:"fg.muted",children:"Never snapped"});const S=new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(e.Fragment,{children:[e.jsxs(n,{fontSize:"sm",color:"fg.muted",children:["Snapped on ",S]}),a&&e.jsxs(n,{fontSize:"sm",color:"fg.muted",children:["Imported from snap store"," ",e.jsx(n,{as:"span",fontWeight:"bold",color:"blue.600",children:a})]})]})})()}),p&&e.jsx(g,{size:"md"})]}),e.jsx(w,{open:i,children:e.jsx(z,{children:u?e.jsx(y,{error:u,title:`Error loading channel ${l}`}):p?e.jsx(t,{display:"flex",justifyContent:"center",py:8,children:e.jsx(n,{color:"fg.muted",children:"Loading channel data..."})}):o&&o.length>0?e.jsx(D,{templateColumns:{base:"1fr",lg:"repeat(auto-fit, minmax(600px, 1fr))"},gap:4,justifyItems:"center",children:o.sort((s,a)=>new Date(a.lastModified)-new Date(s.lastModified)).map((s,a)=>e.jsx(L,{item:s,channelId:l},a))}):o&&o.length===0?e.jsx(t,{display:"flex",justifyContent:"center",py:8,children:e.jsx(n,{color:"fg.muted",children:"This channel has no projects"})}):d?e.jsx(t,{display:"flex",justifyContent:"center",py:8,children:e.jsx(n,{color:"fg.muted",children:"No content available for this channel"})}):e.jsx(t,{display:"flex",justifyContent:"center",py:8,children:e.jsx(n,{color:"fg.muted",children:"Scroll down to load content..."})})})}),!i&&o&&o.length>0&&e.jsx(t,{display:"flex",justifyContent:"center",py:4,children:e.jsxs(n,{fontSize:"sm",color:"gray.600",fontStyle:"italic",children:[o.length," project",o.length!==1?"s":""," (collapsed)"]})})]})},B=()=>{const{data:l,isLoading:d,error:h}=m({queryKey:["info"],queryFn:()=>b("/api/info")}),i=l?.channels?.map(r=>r.id)||[],x=d,c=h;return x?e.jsx(t,{display:"flex",justifyContent:"center",mt:10,children:e.jsx(g,{size:"xl"})}):c?e.jsx(t,{mt:5,px:6,children:e.jsx(y,{error:c})}):e.jsx(t,{py:6,px:6,children:e.jsxs(C,{gap:6,align:"center",children:[i.map(r=>e.jsx(v,{channelId:r},r)),i.length===0&&!x&&e.jsx(n,{mt:4,color:"fg.muted",children:"No channels found."})]})})};export{B as default};
