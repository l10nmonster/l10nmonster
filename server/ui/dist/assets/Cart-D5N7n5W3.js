import{r as a,m as p,j as e,v as Ze,w as Ke,x as et,y as tt,z as rt,A as ot,C as st,b as nt,k as it,D as at,G as lt,H as se,I as ct,J as ae,K as dt,L as ut,M as pt,B as u,F as D,T as d,S as ht,e as T}from"./index-7BvmfFYo.js";import{u as gt}from"./useQuery-BJCiEOEF.js";import{c as le,a as mt,b as xt,d as ft,f as bt}from"./api-lUcpjS_e.js";import{V as I}from"./v-stack-CIRZgxKK.js";import{B as ne}from"./badge-BwRiDO79.js";import{e as N,c as O,a as g,f as M,u as ce,b as de,d as ue,n as pe}from"./index-DYRyEtJ_.js";import{u as he}from"./use-field-context-BUNHqjYw.js";import{b as L,a as E,s as J,P as $}from"./use-presence-context-BX_JHICA.js";const[ge,jt]=O({name:"RenderStrategyContext",hookName:"useRenderStrategyContext",providerName:"<RenderStrategyPropsProvider />"}),me=t=>N()(t,["lazyMount","unmountOnExit"]),[xe,w]=O({name:"DialogContext",hookName:"useDialogContext",providerName:"<DialogProvider />"}),fe=a.forwardRef((t,r)=>{const s=w(),o=jt(),n=L({...o,present:s.open}),l=p(s.getBackdropProps(),n.getPresenceProps(),t);return n.unmounted?null:e.jsx(g.div,{...l,ref:M(n.ref,r)})});fe.displayName="DialogBackdrop";const be=a.forwardRef((t,r)=>{const s=w(),o=p(s.getCloseTriggerProps(),t);return e.jsx(g.button,{...o,ref:r})});be.displayName="DialogCloseTrigger";const je=a.forwardRef((t,r)=>{const s=w(),o=E(),n=p(s.getContentProps(),o.getPresenceProps(),t);return o.unmounted?null:e.jsx(g.div,{...n,ref:M(o.ref,r)})});je.displayName="DialogContent";const Se=a.forwardRef((t,r)=>{const s=w(),o=p(s.getDescriptionProps(),t);return e.jsx(g.div,{...o,ref:r})});Se.displayName="DialogDescription";const Pe=a.forwardRef((t,r)=>{const s=w(),o=p(s.getPositionerProps(),t);return E().unmounted?null:e.jsx(g.div,{...o,ref:r})});Pe.displayName="DialogPositioner";const St=t=>{const r=a.useId(),{getRootNode:s}=ce(),{dir:o}=de(),n={id:r,getRootNode:s,dir:o,...t},l=ue(Ze,n);return Ke(l,pe)},Pt=t=>{const[r,{children:s,...o}]=J(t),[n]=me(r),l=St(o),c=L(p({present:l.open},r));return e.jsx(xe,{value:l,children:e.jsx(ge,{value:n,children:e.jsx($,{value:c,children:s})})})},vt=t=>{const[r,{value:s,children:o}]=J(t),[n]=me(r),l=L(p({present:s.open},r));return e.jsx(xe,{value:s,children:e.jsx(ge,{value:n,children:e.jsx($,{value:l,children:o})})})},ve=a.forwardRef((t,r)=>{const s=w(),o=p(s.getTitleProps(),t);return e.jsx(g.h2,{...o,ref:r})});ve.displayName="DialogTitle";const Ce=a.forwardRef((t,r)=>{const s=w(),o=E(),n=p({...s.getTriggerProps(),"aria-controls":o.unmounted?void 0:s.getTriggerProps()["aria-controls"]},t);return e.jsx(g.button,{...n,ref:r})});Ce.displayName="DialogTrigger";var Ct=t=>{if(!t)return;const r=et(t),s=tt(t),o=rt(t),n=()=>{requestAnimationFrame(()=>{t.style.height="auto";let x;r.boxSizing==="content-box"?x=t.scrollHeight-(parseFloat(r.paddingTop)+parseFloat(r.paddingBottom)):x=t.scrollHeight+parseFloat(r.borderTopWidth)+parseFloat(r.borderBottomWidth),r.maxHeight!=="none"&&x>parseFloat(r.maxHeight)?(r.overflowY==="hidden"&&(t.style.overflowY="scroll"),x=parseFloat(r.maxHeight)):r.overflowY!=="hidden"&&(t.style.overflowY="hidden"),t.style.height=`${x}px`})};t.addEventListener("input",n),t.form?.addEventListener("reset",n);const l=Object.getPrototypeOf(t),c=Object.getOwnPropertyDescriptor(l,"value");Object.defineProperty(t,"value",{...c,set(){c?.set?.apply(this,arguments),n()}});const b=new s.ResizeObserver(()=>{requestAnimationFrame(()=>n())});b.observe(t);const v=new s.MutationObserver(()=>n());return v.observe(t,{attributes:!0,attributeFilter:["rows","placeholder"]}),o.fonts?.addEventListener("loadingdone",n),()=>{t.removeEventListener("input",n),t.form?.removeEventListener("reset",n),o.fonts?.removeEventListener("loadingdone",n),b.disconnect(),v.disconnect()}};const ye=a.forwardRef((t,r)=>{const{autoresize:s,...o}=t,n=a.useRef(null),l=he(),c=p(l?.getTextareaProps(),{style:{resize:s?"none":void 0}},o);return a.useEffect(()=>{if(s)return Ct(n.current)},[s]),e.jsx(g.textarea,{...c,ref:M(r,n)})});ye.displayName="FieldTextarea";const[we,P]=O({name:"SelectContext",hookName:"useSelectContext",providerName:"<SelectProvider />"}),Ae=a.forwardRef((t,r)=>{const s=P(),o=p(s.getClearTriggerProps(),t);return e.jsx(g.button,{...o,ref:r})});Ae.displayName="SelectClearTrigger";const Te=a.forwardRef((t,r)=>{const s=P(),o=E(),n=p(s.getContentProps(),o.getPresenceProps(),t);return o.unmounted?null:e.jsx(g.div,{...n,ref:M(o.ref,r)})});Te.displayName="SelectContent";const Re=a.forwardRef((t,r)=>{const s=P(),o=p(s.getControlProps(),t);return e.jsx(g.div,{...o,ref:r})});Re.displayName="SelectControl";const Ie=a.forwardRef((t,r)=>{const s=P(),o=p(s.getIndicatorProps(),t);return e.jsx(g.div,{...o,ref:r})});Ie.displayName="SelectIndicator";const[yt,Kt]=O({name:"SelectItemContext",hookName:"useSelectItemContext",providerName:"<SelectItemProvider />"}),[wt,Oe]=O({name:"SelectItemPropsContext",hookName:"useSelectItemPropsContext",providerName:"<SelectItemPropsProvider />"}),ze=a.forwardRef((t,r)=>{const[s,o]=N()(t,["item","persistFocus"]),n=P(),l=p(n.getItemProps(s),o),c=n.getItemState(s);return e.jsx(wt,{value:s,children:e.jsx(yt,{value:c,children:e.jsx(g.div,{...l,ref:r})})})});ze.displayName="SelectItem";const[At,Tt]=O({name:"SelectItemGroupPropsContext",hookName:"useSelectItemGroupPropsContext",providerName:"<SelectItemGroupPropsProvider />"}),De=a.forwardRef((t,r)=>{const s=a.useId(),[o,n]=N()(t,["id"]),l={id:s,...o},c=P(),b=p(c.getItemGroupProps(l),n);return e.jsx(At,{value:l,children:e.jsx(g.div,{...b,ref:r})})});De.displayName="SelectItemGroup";const Ne=a.forwardRef((t,r)=>{const s=P(),o=Tt(),n=p(s.getItemGroupLabelProps({htmlFor:o.id}),t);return e.jsx(g.div,{...n,ref:r})});Ne.displayName="SelectItemGroupLabel";const Le=a.forwardRef((t,r)=>{const s=P(),o=Oe(),n=p(s.getItemIndicatorProps(o),t);return e.jsx(g.div,{...n,ref:r})});Le.displayName="SelectItemIndicator";const Ee=a.forwardRef((t,r)=>{const s=P(),o=Oe(),n=p(s.getItemTextProps(o),t);return e.jsx(g.span,{...n,ref:r})});Ee.displayName="SelectItemText";const We=a.forwardRef((t,r)=>{const s=P(),o=p(s.getLabelProps(),t);return e.jsx(g.label,{...o,ref:r})});We.displayName="SelectLabel";const ke=a.forwardRef((t,r)=>{const s=P(),o=p(s.getPositionerProps(),t);return E().unmounted?null:e.jsx(g.div,{...o,ref:r})});ke.displayName="SelectPositioner";const Rt=t=>{const r=a.useId(),{dir:s}=de(),{getRootNode:o}=ce(),n=he(),l={id:r,ids:{label:n?.ids.label,hiddenSelect:n?.ids.control},disabled:n?.disabled,readOnly:n?.readOnly,invalid:n?.invalid,required:n?.required,dir:s,getRootNode:o,...t},c=ue(ot,l);return st(c,pe)},It=(t,r)=>{const[s,o]=J(t),[n,l]=N()(o,["closeOnSelect","collection","composite","defaultHighlightedValue","defaultOpen","defaultValue","deselectable","disabled","form","highlightedValue","id","ids","invalid","loopFocus","multiple","name","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","onValueChange","open","positioning","readOnly","required","scrollToIndexFn","value"]),c=Rt(n),b=L(p({present:c.open},s)),v=p(c.getRootProps(),l);return e.jsx(we,{value:c,children:e.jsx($,{value:b,children:e.jsx(g.div,{...v,ref:r})})})},Ot=a.forwardRef(It),zt=(t,r)=>{const[s,o]=J(t),[{value:n},l]=N()(o,["value"]),c=L(p({present:n.open},s)),b=p(n.getRootProps(),l);return e.jsx(we,{value:n,children:e.jsx($,{value:c,children:e.jsx(g.div,{...b,ref:r})})})},Dt=a.forwardRef(zt),Fe=a.forwardRef((t,r)=>{const s=P(),o=p(s.getTriggerProps(),t);return e.jsx(g.button,{...o,ref:r})});Fe.displayName="SelectTrigger";const Me=a.forwardRef((t,r)=>{const{children:s,placeholder:o,...n}=t,l=P(),c=p(l.getValueTextProps(),n);return e.jsx(g.span,{...c,ref:r,children:s||l.valueAsString||o})});Me.displayName="SelectValueText";const{withRootProvider:Je,withContext:y}=le({key:"dialog"});Je(vt,{defaultProps:{unmountOnExit:!0,lazyMount:!0}});const H=Je(Pt,{defaultProps:{unmountOnExit:!0,lazyMount:!0}});y(Ce,"trigger",{forwardAsChild:!0});const V=y(Pe,"positioner",{forwardAsChild:!0}),q=y(je,"content",{forwardAsChild:!0});y(Se,"description",{forwardAsChild:!0});const Y=y(ve,"title",{forwardAsChild:!0}),Q=y(be,"closeTrigger",{forwardAsChild:!0});a.forwardRef(function(r,s){const o=w();return e.jsx(nt.button,{...r,ref:s,onClick:()=>o.setOpen(!1)})});const _=y(fe,"backdrop",{forwardAsChild:!0}),X=y("div","body");y("div","footer");const Z=y("div","header"),{withProvider:$e,withContext:S}=le({key:"select"});$e(Dt,"root",{forwardAsChild:!0});const Nt=$e(Ot,"root",{forwardAsChild:!0,defaultProps:{positioning:{sameWidth:!0}}}),Lt=S(Fe,"trigger",{forwardAsChild:!0}),Et=S(ke,"positioner",{forwardAsChild:!0}),Wt=S(Te,"content",{forwardAsChild:!0});S(Me,"valueText",{forwardAsChild:!0});S(Ae,"clearTrigger",{forwardAsChild:!0,defaultProps:{children:e.jsx(ft,{boxSize:"1em"})}});S(De,"itemGroup",{forwardAsChild:!0});S(Ne,"itemGroupLabel",{forwardAsChild:!0});const kt=S(ze,"item",{forwardAsChild:!0}),Ft=S(Ee,"itemText",{forwardAsChild:!0}),Mt=S(Le,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:e.jsx(xt,{})}});S("div","indicatorGroup");const Jt=S(Ie,"indicator",{forwardAsChild:!0,defaultProps:{children:e.jsx(mt,{})}});S(Re,"control",{forwardAsChild:!0});S(We,"label",{forwardAsChild:!0});const{withContext:$t}=it({key:"textarea"}),Bt=$t(ye);var Gt=class extends at{#r;#o=void 0;#e;#t;constructor(t,r){super(),this.#r=t,this.setOptions(r),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const r=this.options;this.options=this.#r.defaultMutationOptions(t),lt(this.options,r)||this.#r.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&se(r.mutationKey)!==se(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#n(t)}getCurrentResult(){return this.#o}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#s(),this.#n()}mutate(t,r){return this.#t=r,this.#e?.removeObserver(this),this.#e=this.#r.getMutationCache().build(this.#r,this.options),this.#e.addObserver(this),this.#e.execute(t)}#s(){const t=this.#e?.state??ct();this.#o={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#n(t){ae.batch(()=>{if(this.#t&&this.hasListeners()){const r=this.#o.variables,s=this.#o.context;t?.type==="success"?(this.#t.onSuccess?.(t.data,r,s),this.#t.onSettled?.(t.data,null,r,s)):t?.type==="error"&&(this.#t.onError?.(t.error,r,s),this.#t.onSettled?.(void 0,t.error,r,s))}this.listeners.forEach(r=>{r(this.#o)})})}};function ie(t,r){const s=dt(),[o]=a.useState(()=>new Gt(s,t));a.useEffect(()=>{o.setOptions(t)},[o,t]);const n=a.useSyncExternalStore(a.useCallback(c=>o.subscribe(ae.batchCalls(c)),[o]),()=>o.getCurrentResult(),()=>o.getCurrentResult()),l=a.useCallback((c,b)=>{o.mutate(c,b).catch(ut)},[o]);if(n.error&&pt(o.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}const Ut=({langPairKey:t,tus:r,onRemoveTU:s})=>{const[o,n]=a.useState(""),[l,c]=a.useState(!1),[b,v]=a.useState(!1),[x,R]=a.useState(null),[h,j]=a.useState(""),[C,B]=a.useState(""),[A,K]=a.useState(null),[Be,ee]=a.useState(!1),{data:Ge={},isLoading:Ue}=gt({queryKey:["info"],queryFn:()=>bt("/api/info")}),He=Ge.providers||[],te=ie({mutationFn:async({sourceLang:i,targetLang:m,tus:f,providerList:z})=>{const U=await fetch("/api/dispatcher/createJobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceLang:i,targetLang:m,tus:f,providerList:z})});if(!U.ok){const Xe=await U.json();throw new Error(Xe.message||"Failed to create jobs")}return U.json()}}),G=ie({mutationFn:async({jobs:i,instructions:m})=>{const f=await fetch("/api/dispatcher/startJobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobs:i,instructions:m})});if(!f.ok){const z=await f.json();throw new Error(z.message||"Failed to start jobs")}return f.json()}});function re(i){return i.map(m=>typeof m=="string"?m:`{{${m.t}}}`).join("")}function Ve(i){return new Date(i).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}const qe=async()=>{if(!o){alert("Please select a provider first");return}const i=Array.isArray(r)?r:r.tus;try{const f=(await te.mutateAsync({sourceLang:k,targetLang:F,tus:i,providerList:[o]})).find(z=>z.translationProvider===o);f?(R(f),j(""),c(!0)):(B(`Provider "${o}" did not accept any of the selected translation units.`),v(!0))}catch(m){B(`Failed to create job: ${m.message}`),v(!0)}},Ye=i=>{n(i)},Qe=async()=>{if(x)try{const i=await G.mutateAsync({jobs:[x],instructions:h||void 0}),m=i.find(f=>f.jobGuid===x.jobGuid)||i[0];K(m),c(!1),ee(!0)}catch(i){B(`Failed to start job: ${i.message}`),v(!0)}},oe=()=>{if(ee(!1),K(null),R(null),j(""),x&&x.tus){const i=new Set(x.tus.map(f=>f.guid)),m=Array.isArray(r)?r:r.tus;for(let f=m.length-1;f>=0;f--)i.has(m[f].guid)&&s(t,f)}},_e=i=>i===0?"Free":i==null?"Unknown":`$${i.toFixed(2)}`,W=Array.isArray(r)?r:r.tus,k=Array.isArray(r)?t.split("|")[0]||t.split("→")[0]:r.sourceLang,F=Array.isArray(r)?t.split("|")[1]||t.split("→").slice(1).join("→"):r.targetLang;return e.jsxs(u,{p:6,borderWidth:"1px",borderRadius:"lg",bg:"white",shadow:"sm",children:[e.jsxs(I,{gap:4,align:"stretch",children:[e.jsx(u,{children:e.jsxs(D,{align:"center",justify:"space-between",mb:2,children:[e.jsxs(D,{align:"center",gap:3,children:[e.jsx(ne,{colorPalette:"blue",size:"sm",children:k}),e.jsx(d,{color:"fg.muted",fontSize:"lg",children:"→"}),e.jsx(ne,{colorPalette:"green",size:"sm",children:F}),e.jsxs(D,{align:"center",gap:3,ml:4,children:[e.jsxs(Nt,{size:"sm",width:"250px",value:o?[o]:[],onValueChange:i=>{},positioning:{strategy:"absolute",placement:"bottom-start",flip:!0,gutter:4},children:[e.jsxs(Lt,{children:[e.jsx(d,{fontSize:"sm",flex:"1",textAlign:"left",children:o||"Select Provider"}),e.jsx(Jt,{})]}),e.jsx(Et,{children:e.jsx(Wt,{zIndex:1e3,bg:"white",borderWidth:"1px",borderColor:"border.default",borderRadius:"md",shadow:"lg",minW:"250px",maxH:"200px",overflow:"auto",children:Ue?e.jsxs(u,{p:3,textAlign:"center",children:[e.jsx(ht,{size:"sm"}),e.jsx(d,{fontSize:"sm",color:"fg.muted",mt:2,children:"Loading providers..."})]}):He.map(i=>e.jsxs(kt,{item:i,value:i,onClick:()=>Ye(i),children:[e.jsx(Ft,{children:i}),e.jsx(Mt,{})]},i))})})]}),e.jsx(T,{size:"sm",colorPalette:"blue",onClick:qe,disabled:!o,loading:te.isPending,children:"Create Job"})]})]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:[W.length," ",W.length===1?"TU":"TUs"]})]})}),e.jsx(u,{bg:"white",borderRadius:"md",overflow:"auto",children:e.jsxs(u,{as:"table",w:"100%",fontSize:"sm",children:[e.jsx(u,{as:"thead",bg:"blue.subtle",borderBottom:"2px",borderColor:"blue.muted",shadow:"sm",children:e.jsxs(u,{as:"tr",children:[e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"left",minW:"120px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"GUID"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"left",minW:"350px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"SOURCE"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"left",minW:"350px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"TARGET"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"center",minW:"40px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"QUALITY"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"left",minW:"120px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"PROVIDER"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"left",minW:"120px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"TIMESTAMP"})}),e.jsx(u,{as:"th",p:3,borderBottom:"1px",borderColor:"border.default",textAlign:"center",minW:"100px",children:e.jsx(d,{fontSize:"sm",fontWeight:"bold",color:"blue.600",children:"ACTION"})})]})}),e.jsx(u,{as:"tbody",children:W.map((i,m)=>e.jsxs(u,{as:"tr",_hover:{bg:"gray.subtle"},children:[e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",children:e.jsx(d,{fontSize:"xs",fontFamily:"mono",color:"blue.600",userSelect:"all",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxW:"100px",children:i.guid})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",children:e.jsx(d,{fontSize:"xs",noOfLines:2,dir:k?.startsWith("he")||k?.startsWith("ar")?"rtl":"ltr",children:Array.isArray(i.nsrc)?re(i.nsrc):i.nsrc})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",children:e.jsx(d,{fontSize:"xs",noOfLines:2,dir:F?.startsWith("he")||F?.startsWith("ar")?"rtl":"ltr",children:Array.isArray(i.ntgt)?re(i.ntgt):i.ntgt})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",textAlign:"center",children:e.jsx(d,{fontSize:"xs",children:i.q})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",children:e.jsx(d,{fontSize:"xs",children:i.translationProvider||i.provider})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",children:e.jsx(d,{fontSize:"xs",color:"fg.muted",children:Ve(i.ts)})}),e.jsx(u,{as:"td",p:3,borderBottom:"1px",borderColor:"border.subtle",textAlign:"center",children:e.jsx(T,{size:"xs",colorPalette:"red",variant:"outline",onClick:()=>s(t,m),children:"Remove"})})]},`${i.guid}-${m}`))})]})})]}),e.jsxs(H,{open:l,onOpenChange:i=>c(i.open),children:[e.jsx(_,{}),e.jsx(V,{children:e.jsxs(q,{maxW:"500px",children:[e.jsxs(Z,{children:[e.jsx(Y,{children:"Job Created Successfully"}),e.jsx(Q,{})]}),e.jsx(X,{children:x&&e.jsxs(I,{gap:4,align:"stretch",children:[e.jsxs(u,{children:[e.jsxs(d,{fontSize:"lg",fontWeight:"bold",color:"green.600",children:[x.tus?.length||0," TUs accepted out of ",W.length," sent"]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Provider: ",o]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Estimated Cost: ",_e(x.estimatedCost)]})]}),e.jsxs(u,{children:[e.jsx(d,{fontSize:"sm",fontWeight:"bold",mb:2,children:"Job Instructions (optional):"}),e.jsx(Bt,{placeholder:"Enter any specific instructions for this translation job...",value:h,onChange:i=>j(i.target.value),rows:3})]}),e.jsxs(D,{gap:3,children:[e.jsx(T,{colorPalette:"gray",variant:"outline",onClick:()=>{c(!1),R(null),j("")},flex:"1",disabled:G.isPending,children:"Cancel"}),e.jsx(T,{colorPalette:"green",onClick:Qe,loading:G.isPending,flex:"1",children:"Push Job"})]})]})})]})})]}),e.jsxs(H,{open:b,onOpenChange:i=>v(i.open),children:[e.jsx(_,{}),e.jsx(V,{children:e.jsxs(q,{maxW:"400px",children:[e.jsxs(Z,{children:[e.jsx(Y,{children:"Job Creation Failed"}),e.jsx(Q,{})]}),e.jsx(X,{children:e.jsxs(I,{gap:4,align:"stretch",children:[e.jsx(d,{color:"red.600",children:C}),e.jsx(T,{colorPalette:"red",onClick:()=>v(!1),w:"100%",children:"Close"})]})})]})})]}),e.jsxs(H,{open:Be,onOpenChange:i=>{i.open||oe()},children:[e.jsx(_,{}),e.jsx(V,{children:e.jsxs(q,{maxW:"400px",children:[e.jsxs(Z,{children:[e.jsx(Y,{children:"Job Status"}),e.jsx(Q,{})]}),e.jsx(X,{children:A&&e.jsxs(I,{gap:4,align:"stretch",children:[e.jsxs(u,{children:[e.jsx(d,{fontSize:"lg",fontWeight:"bold",color:"blue.600",children:"Job Started Successfully"}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Job ID: ",A.jobGuid]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Provider: ",A.translationProvider]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Language Pair: ",A.sourceLang," → ",A.targetLang]}),e.jsxs(d,{fontSize:"sm",color:"fg.muted",children:["Status: ",e.jsx(d,{as:"span",fontWeight:"bold",color:A.status==="completed"?"green.600":"orange.600",children:A.status})]})]}),e.jsx(u,{children:e.jsx(T,{colorPalette:"blue",onClick:oe,w:"100%",children:"Close & Remove TUs from Cart"})})]})})]})})]})]})},er=()=>{const[t,r]=a.useState({}),[s,o]=a.useState(!0),n=()=>{try{const h=sessionStorage.getItem("tmCart");return h?JSON.parse(h):{}}catch(h){return console.error("Error loading cart:",h),{}}},l=h=>{sessionStorage.setItem("tmCart",JSON.stringify(h)),window.dispatchEvent(new Event("cartUpdated"))},c=()=>{o(!0);const h=n();r(h),o(!1)},b=(h,j)=>{const C=n();C[h]&&(Array.isArray(C[h])?(C[h].splice(j,1),C[h].length===0&&delete C[h]):(C[h].tus.splice(j,1),C[h].tus.length===0&&delete C[h]),l(C),c())},v=()=>{l({}),c()},x=()=>Object.values(t).reduce((h,j)=>Array.isArray(j)?h+j.length:h+(j.tus?j.tus.length:0),0);if(a.useEffect(()=>{c()},[]),s)return e.jsx(u,{py:6,px:6,children:e.jsx(d,{children:"Loading cart..."})});const R=x();return e.jsx(u,{py:6,px:6,children:e.jsxs(I,{gap:6,align:"stretch",children:[e.jsxs(D,{align:"center",justify:"space-between",children:[e.jsx(d,{fontSize:"2xl",fontWeight:"bold",children:"Translation Memory Cart"}),R>0&&e.jsx(T,{colorPalette:"red",variant:"outline",onClick:v,children:"Empty Cart"})]}),R===0?e.jsxs(u,{p:8,textAlign:"center",borderWidth:"1px",borderRadius:"lg",bg:"bg.muted",children:[e.jsx(d,{fontSize:"lg",color:"fg.default",mb:2,children:"Your cart is empty"}),e.jsx(d,{color:"fg.muted",children:"Add translation units from the TM pages to get started"})]}):e.jsx(I,{gap:6,align:"stretch",children:Object.entries(t).map(([h,j])=>e.jsx(Ut,{langPairKey:h,tus:j,onRemoveTU:b},h))})]})})};export{er as default};
