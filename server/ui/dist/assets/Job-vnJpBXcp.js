import{r as p,W as I,X as $,m as S,j as e,e as D,B as o,S as G,T as t,F as f,f as q}from"./index-CE6JgXwC.js";import{A as V}from"./namespace-DqVzlNZ0.js";import{B as u}from"./badge-D0XxOmqE.js";import{c as H,f as M}from"./api-CQ_emPlI.js";import{e as v,b as K,u as Q,d as X,n as Y,c as Z,a as w}from"./index-BHll-Wur.js";import{S as _,V as j}from"./v-stack-BLV93Nj6.js";import{u as ee}from"./useQuery-DJATtsyt.js";const re=n=>v()(n,["defaultOpen","disabled","id","ids","lazyMount","onExitComplete","onOpenChange","open","unmountOnExit"]),te=(n={})=>{const{lazyMount:i,unmountOnExit:l,...s}=n,h=p.useId(),g=p.useRef(!1),{dir:C}=K(),{getRootNode:z}=Q(),y={id:h,dir:C,getRootNode:z,...s},b=X(I,y),r=$(b,Y);r.visible&&(g.current=!0);const a=!r.visible&&!g.current&&i||l&&!r.visible&&g.current;return{...r,isUnmounted:a}},[T,F]=Z({name:"CollapsibleContext",hookName:"useCollapsibleContext",providerName:"<CollapsibleProvider />"}),L=p.forwardRef((n,i)=>{const[l,s]=re(n),h=te(l),g=S(h.getRootProps(),s);return e.jsx(T,{value:h,children:e.jsx(w.div,{...g,ref:i})})});L.displayName="CollapsibleRoot";const U=p.forwardRef((n,i)=>{const l=F();if(l.isUnmounted)return null;const s=S(l.getContentProps(),n);return e.jsx(w.div,{...s,ref:i})});U.displayName="CollapsibleContent";const O=p.forwardRef((n,i)=>{const[{value:l},s]=v()(n,["value"]),h=S(l.getRootProps(),s);return e.jsx(T,{value:l,children:e.jsx(w.div,{...h,ref:i})})});O.displayName="CollapsibleRootProvider";const B=p.forwardRef((n,i)=>{const l=F(),s=S(l.getTriggerProps(),n);return e.jsx(w.button,{...s,ref:i})});B.displayName="CollapsibleTrigger";const{withProvider:E,withContext:J}=H({key:"collapsible"});E(O,"root",{forwardAsChild:!0});const se=E(L,"root",{forwardAsChild:!0});J(B,"trigger",{forwardAsChild:!0});const oe=J(U,"content",{forwardAsChild:!0}),k=p.forwardRef(function(i,l){return e.jsx(_,{align:"center",...i,direction:"row",ref:l})});function N(n){return n.map(i=>typeof i=="string"?i:`{{${i.t}}}`).join("")}function R(n){return new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function ne(n){return n===0?"Free":n==null?"Unknown":`$${n.toFixed(2)}`}const fe=()=>{const{jobGuid:n}=D(),[i,l]=p.useState({}),{data:s,isLoading:h,error:g}=ee({queryKey:["job",n],queryFn:()=>M(`/api/tm/job/${n}`),retry:(r,a)=>a?.status===404?!1:r<3});if(h)return e.jsx(o,{display:"flex",justifyContent:"center",mt:10,children:e.jsx(G,{size:"xl"})});if(g)return e.jsx(o,{mt:5,px:6,children:e.jsxs(o,{p:4,bg:"red.subtle",borderRadius:"md",borderWidth:"1px",borderColor:"red.muted",children:[e.jsx(t,{fontWeight:"bold",color:"red.600",mb:2,children:"Error"}),e.jsx(t,{color:"red.600",children:g?.message||"Failed to fetch job data"})]})});if(!s)return e.jsx(o,{mt:5,px:6,children:e.jsx(V,{status:"warning",children:e.jsxs(o,{children:[e.jsx(t,{fontWeight:"bold",children:"Job Not Found"}),e.jsxs(t,{children:["Job with GUID ",n," was not found."]})]})})});const C=r=>{switch(r?.toLowerCase()){case"done":case"completed":return"green";case"failed":case"error":return"red";case"in-progress":case"running":return"orange";default:return"gray"}},z=(r,a)=>{const x=new Set(["jobGuid","guid","rid","sid","nsrc","ntgt","notes","q","prj"]),P=Object.entries(r).filter(([d])=>!x.has(d)),A=r.guid||a,W=i[A]||!1;return e.jsx(o,{p:4,borderWidth:"1px",borderRadius:"lg",bg:"white",shadow:"sm",mb:4,children:e.jsxs(j,{gap:3,align:"stretch",children:[e.jsx(f,{justify:"space-between",align:"start",wrap:"wrap",children:e.jsxs(j,{gap:1,align:"stretch",children:[e.jsxs(f,{align:"center",gap:2,children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"GUID:"}),e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",wordBreak:"break-all",children:r.guid})]}),r.rid&&e.jsxs(f,{align:"center",gap:2,children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"RID:"}),e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",wordBreak:"break-all",children:r.rid})]}),r.sid&&e.jsxs(f,{align:"center",gap:2,children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"SID:"}),e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",children:r.sid})]})]})}),e.jsxs(o,{children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"Source:"}),e.jsx(t,{fontSize:"sm",p:2,bg:"blue.subtle",borderRadius:"md",dir:s.sourceLang?.startsWith("he")||s.sourceLang?.startsWith("ar")?"rtl":"ltr",children:Array.isArray(r.nsrc)?N(r.nsrc):r.nsrc})]}),e.jsxs(o,{children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"Target:"}),e.jsx(t,{fontSize:"sm",p:2,bg:"green.subtle",borderRadius:"md",dir:s.targetLang?.startsWith("he")||s.targetLang?.startsWith("ar")?"rtl":"ltr",children:Array.isArray(r.ntgt)?N(r.ntgt):r.ntgt})]}),r.notes&&e.jsxs(o,{children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",color:"fg.muted",children:"Notes:"}),e.jsxs(o,{p:2,bg:"yellow.subtle",borderRadius:"md",children:[r.notes.desc&&e.jsx(t,{fontSize:"xs",mb:2,whiteSpace:"pre-wrap",children:r.notes.desc}),r.notes.ph&&e.jsxs(o,{children:[e.jsx(t,{fontSize:"xs",fontWeight:"bold",mb:1,children:"Placeholders:"}),Object.entries(r.notes.ph).map(([d,c])=>e.jsxs(o,{mb:1,children:[e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",children:d}),e.jsxs(t,{fontSize:"xs",color:"gray.600",children:[c.desc," (e.g., ",c.sample,")"]})]},d))]})]})]}),P.length>0&&e.jsxs(o,{children:[e.jsxs(f,{align:"center",justify:"space-between",mb:2,children:[e.jsx(q,{size:"xs",variant:"ghost",onClick:()=>l(d=>({...d,[A]:!W})),p:1,children:e.jsx(t,{fontSize:"xs",color:"blue.600",children:W?"Hide additional properties":`Show ${P.length} additional properties`})}),e.jsxs(k,{gap:2,children:[r.prj&&e.jsx(u,{size:"sm",colorPalette:"purple",children:r.prj}),r.q&&e.jsxs(u,{size:"sm",colorPalette:"blue",children:["Q: ",r.q]})]})]}),e.jsx(se,{open:W,children:e.jsx(oe,{children:e.jsx(o,{p:3,bg:"gray.subtle",borderRadius:"md",children:P.map(([d,c])=>{let m=c;return d==="ts"&&typeof c=="number"?m=R(c):typeof c=="object"?m=JSON.stringify(c,null,2):m=String(c),e.jsxs(f,{align:"start",mb:2,gap:2,children:[e.jsxs(t,{fontSize:"xs",fontWeight:"bold",color:"gray.600",minW:"fit-content",children:[d,":"]}),e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",flex:"1",wordBreak:"break-all",children:m})]},d)})})})})]})]})},r.guid||a)},y=new Set(["jobGuid","sourceLang","targetLang","translationProvider","updatedAt","taskName","inflight","status","tus","estimatedCost"]),b=Object.entries(s).filter(([r])=>!y.has(r));return e.jsxs(o,{p:6,minH:"100vh",bg:"gray.50",children:[e.jsxs(t,{fontSize:"3xl",fontWeight:"bold",mb:6,color:"fg.default",children:["Job ",s.jobGuid]}),e.jsxs(j,{gap:6,align:"stretch",maxW:"6xl",mx:"auto",children:[e.jsx(o,{p:6,bg:"white",borderRadius:"lg",shadow:"sm",children:e.jsxs(j,{gap:4,align:"stretch",children:[e.jsxs(f,{justify:"space-between",align:"center",wrap:"wrap",children:[e.jsxs(k,{gap:6,wrap:"wrap",align:"center",children:[e.jsxs(o,{children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",children:"Language Pair:"}),e.jsxs(t,{fontSize:"sm",children:[s.sourceLang," â†’ ",s.targetLang]})]}),e.jsxs(o,{children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",children:"Provider:"}),e.jsx(t,{fontSize:"sm",children:s.translationProvider})]}),s.updatedAt&&e.jsxs(o,{children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",children:"Updated:"}),e.jsx(t,{fontSize:"sm",children:R(new Date(s.updatedAt).getTime())})]}),s.taskName&&e.jsxs(o,{children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",children:"Task:"}),e.jsx(t,{fontSize:"sm",children:s.taskName})]}),s.estimatedCost!==void 0&&e.jsxs(o,{children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",children:"Estimated Cost:"}),e.jsx(t,{fontSize:"sm",children:ne(s.estimatedCost)})]}),s.inflight?.length>0&&e.jsxs(u,{colorPalette:"orange",size:"sm",children:[s.inflight.length," TUs In Flight"]})]}),e.jsx(u,{size:"lg",colorPalette:C(s.status),children:s.status?.toUpperCase()})]}),b.length>0&&e.jsxs(o,{mt:4,pt:4,borderTop:"1px",borderColor:"border.default",children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"fg.muted",mb:3,children:"Additional Properties"}),e.jsx(o,{bg:"gray.subtle",p:3,borderRadius:"md",children:b.map(([r,a])=>{let x=a;return r==="ts"&&typeof a=="number"?x=R(a):typeof a=="object"?x=JSON.stringify(a,null,2):x=String(a),e.jsxs(f,{align:"start",mb:2,gap:2,children:[e.jsxs(t,{fontSize:"xs",fontWeight:"bold",color:"gray.600",minW:"fit-content",children:[r,":"]}),e.jsx(t,{fontSize:"xs",fontFamily:"mono",color:"blue.600",flex:"1",wordBreak:"break-all",children:x})]},r)})})]})]})}),s.inflight?.length>0&&e.jsxs(o,{p:4,bg:"orange.subtle",borderRadius:"lg",borderWidth:"1px",borderColor:"orange.muted",children:[e.jsx(t,{fontSize:"sm",fontWeight:"bold",color:"orange.700",mb:2,children:"Translation In Progress"}),e.jsxs(t,{fontSize:"sm",color:"orange.600",children:[s.inflight.length," translation unit",s.inflight.length===1?"":"s"," ",s.inflight.length===1?"is":"are"," still being translated."]})]}),e.jsxs(o,{children:[e.jsxs(t,{fontSize:"xl",fontWeight:"bold",mb:4,children:["Translation Units (",s.tus?.length||0,")"]}),s.tus?.length>0?s.tus.map((r,a)=>z(r,a)):e.jsx(o,{p:6,bg:"white",borderRadius:"lg",textAlign:"center",children:e.jsx(t,{color:"fg.muted",children:"No translation units found."})})]})]})]})};export{fe as default};
